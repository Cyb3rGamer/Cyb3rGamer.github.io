<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Do I Own?</title>
  <link rel="stylesheet" href="shared.css">
</head>

<body>
  <div class="container">
    <header>
      <h1>Do I Own?</h1>
      <button id="themeToggle">ðŸŒ™ Toggle Dark Mode</button>
    </header>
    <p>Enter a list of app IDs (one per line) to check ownership:</p>
    <textarea id="inputNumbers" placeholder="e.g.\n440\n570\n730"></textarea>
    <div class="controls">
      <button id="checkButton">Check Ownership</button>
    </div>
    <div id="results"></div>
  </div>

  <script>
    const themeToggle = document.getElementById('themeToggle');
    const html = document.documentElement;

    // Initialize theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      html.setAttribute('data-theme', savedTheme);
      themeToggle.textContent = savedTheme === 'dark' ? 'â˜€ï¸ Light Mode' : 'ðŸŒ™ Dark Mode';
    }

    themeToggle.addEventListener('click', () => {
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      themeToggle.textContent = newTheme === 'dark' ? 'â˜€ï¸ Light Mode' : 'ðŸŒ™ Dark Mode';
    });

    document.getElementById('checkButton').addEventListener('click', async () => {
      const inputText = document.getElementById('inputNumbers').value;
      const inputNumbers = inputText.split('\n').map(num => num.trim()).filter(num => num !== '');

      const resultsDiv = document.getElementById('results');
      if (inputNumbers.length === 0) {
        resultsDiv.innerHTML = '<p>Please enter some app IDs.</p>';
        return;
      }

      resultsDiv.innerHTML = '<p>Checking ownership...</p>';

      try {
        const response = await fetch('https://cyb3rgamer.github.io/Cyb3rGamer_appid_list.json');
        if (!response.ok) {
          throw new Error('Failed to fetch the appid list.');
        }

        const ownedNumbers = await response.json();
        const ownedSet = new Set(ownedNumbers);

        resultsDiv.innerHTML = '';
        inputNumbers.forEach(num => {
          const resultSpan = document.createElement('span');
          resultSpan.className = 'result-item';
          resultSpan.textContent = num;

          if (ownedSet.has(Number(num))) {
            resultSpan.classList.add('owned');
            resultSpan.title = 'Owned';
          } else {
            resultSpan.classList.add('not-owned');
            resultSpan.title = 'Not Owned';
          }

          resultsDiv.appendChild(resultSpan);
        });
      } catch (error) {
        resultsDiv.innerHTML = `<p style="color: var(--owned-color);">Error: ${error.message}</p>`;
      }
    });
  </script>
</body>

</html>